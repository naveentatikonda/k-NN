Index: jni/CMakeLists.txt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/jni/CMakeLists.txt b/jni/CMakeLists.txt
--- a/jni/CMakeLists.txt	(revision 8475892ebf7579a06a0aeb923378b9e3bae4c904)
+++ b/jni/CMakeLists.txt	(date 1663802738758)
@@ -16,6 +16,7 @@
 
 set(CMAKE_CXX_STANDARD 11)
 set(CMAKE_CXX_STANDARD_REQUIRED True)
+set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -fpermissive")
 
 option(CONFIG_FAISS "Configure faiss library build when this is on")
 option(CONFIG_NMSLIB "Configure nmslib library build when this is on")
@@ -35,6 +36,9 @@
 elseif(${CMAKE_SYSTEM_NAME} STREQUAL Linux)
     set(JVM_OS_TYPE linux)
     set(LIB_EXT .so)
+elseif(${CMAKE_SYSTEM_NAME} STREQUAL Windows)
+    set(JVM_OS_TYPE win32)
+    set(LIB_EXT .dll)
 else()
     message(FATAL_ERROR "Unable to run on system: ${CMAKE_SYSTEM_NAME}")
 endif()
@@ -57,7 +61,7 @@
 target_include_directories(${TARGET_LIB_COMMON} PRIVATE ${CMAKE_CURRENT_SOURCE_DIR}/include $ENV{JAVA_HOME}/include $ENV{JAVA_HOME}/include/${JVM_OS_TYPE})
 set_target_properties(${TARGET_LIB_COMMON} PROPERTIES SUFFIX ${LIB_EXT})
 set_target_properties(${TARGET_LIB_COMMON} PROPERTIES POSITION_INDEPENDENT_CODE ON)
-set_target_properties(${TARGET_LIB_COMMON} PROPERTIES LIBRARY_OUTPUT_DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR}/release)
+set_target_properties(${TARGET_LIB_COMMON} PROPERTIES RUNTIME_OUTPUT_DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR}/release)
 list(APPEND TARGET_LIBS ${TARGET_LIB_COMMON})
 # ----------------------------------------------------------------------------
 
@@ -79,7 +83,7 @@
     target_include_directories(${TARGET_LIB_NMSLIB} PRIVATE ${CMAKE_CURRENT_SOURCE_DIR}/include $ENV{JAVA_HOME}/include $ENV{JAVA_HOME}/include/${JVM_OS_TYPE} ${CMAKE_CURRENT_SOURCE_DIR}/external/nmslib/similarity_search/include)
     set_target_properties(${TARGET_LIB_NMSLIB} PROPERTIES SUFFIX ${LIB_EXT})
     set_target_properties(${TARGET_LIB_NMSLIB} PROPERTIES POSITION_INDEPENDENT_CODE ON)
-    set_target_properties(${TARGET_LIB_NMSLIB} PROPERTIES LIBRARY_OUTPUT_DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR}/release)
+    set_target_properties(${TARGET_LIB_NMSLIB} PROPERTIES RUNTIME_OUTPUT_DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR}/release)
 
     list(APPEND TARGET_LIBS ${TARGET_LIB_NMSLIB})
 endif ()
@@ -109,7 +113,7 @@
     find_package(OpenMP REQUIRED)
     find_package(ZLIB REQUIRED)
     find_package(BLAS REQUIRED)
-    enable_language(Fortran)
+#    enable_language(Fortran)
     find_package(LAPACK REQUIRED)
 
     # Check if faiss exists
@@ -130,7 +134,7 @@
     target_include_directories(${TARGET_LIB_FAISS} PRIVATE ${CMAKE_CURRENT_SOURCE_DIR}/include $ENV{JAVA_HOME}/include $ENV{JAVA_HOME}/include/${JVM_OS_TYPE} ${CMAKE_CURRENT_SOURCE_DIR}/external/faiss)
     set_target_properties(${TARGET_LIB_FAISS} PROPERTIES SUFFIX ${LIB_EXT})
     set_target_properties(${TARGET_LIB_FAISS} PROPERTIES POSITION_INDEPENDENT_CODE ON)
-    set_target_properties(${TARGET_LIB_FAISS} PROPERTIES LIBRARY_OUTPUT_DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR}/release)
+    set_target_properties(${TARGET_LIB_FAISS} PROPERTIES RUNTIME_OUTPUT_DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR}/release)
 
     list(APPEND TARGET_LIBS ${TARGET_LIB_FAISS})
 endif ()
@@ -138,51 +142,7 @@
 # ---------------------------------------------------------------------------
 
 # --------------------------------- TESTS -----------------------------------
-if (${CONFIG_ALL} STREQUAL ON OR ${CONFIG_TEST} STREQUAL ON)
-    # Reference - https://crascit.com/2015/07/25/cmake-gtest/
-    configure_file(CMakeLists.txt.in googletest-download/CMakeLists.txt)
-    execute_process(COMMAND "${CMAKE_COMMAND}" -G "${CMAKE_GENERATOR}" .
-            WORKING_DIRECTORY "${CMAKE_BINARY_DIR}/googletest-download"
-            )
-    execute_process(COMMAND "${CMAKE_COMMAND}" --build .
-            WORKING_DIRECTORY "${CMAKE_BINARY_DIR}/googletest-download"
-            )
-    set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)
-
-    add_subdirectory("${CMAKE_BINARY_DIR}/googletest-src"
-            "${CMAKE_BINARY_DIR}/googletest-build" EXCLUDE_FROM_ALL
-            )
-    add_executable(
-            jni_test
-            tests/faiss_wrapper_test.cpp
-            tests/nmslib_wrapper_test.cpp
-            tests/test_util.cpp)
-
-    target_link_libraries(
-            jni_test
-            gtest_main
-            gmock_main
-            faiss
-            NonMetricSpaceLib
-            OpenMP::OpenMP_CXX
-            ${TARGET_LIB_FAISS}
-            ${TARGET_LIB_NMSLIB}
-            ${TARGET_LIB_COMMON}
-    )
-
-    target_include_directories(jni_test PRIVATE
-            ${CMAKE_CURRENT_SOURCE_DIR}/tests
-            ${CMAKE_CURRENT_SOURCE_DIR}/include
-            $ENV{JAVA_HOME}/include
-            $ENV{JAVA_HOME}/include/${JVM_OS_TYPE}
-            ${CMAKE_CURRENT_SOURCE_DIR}/external/faiss
-            ${CMAKE_CURRENT_SOURCE_DIR}/external/nmslib/similarity_search/include
-            ${gtest_SOURCE_DIR}/include
-            ${gmock_SOURCE_DIR}/include)
 
-
-    set_target_properties(jni_test PROPERTIES RUNTIME_OUTPUT_DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR}/bin)
-endif ()
 # ---------------------------------------------------------------------------
 
 # -------------------------------- INSTALL ----------------------------------
